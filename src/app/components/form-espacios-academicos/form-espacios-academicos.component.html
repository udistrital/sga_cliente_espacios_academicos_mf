<mat-card>
    <mat-card-header class="header">
        <button mat-raised-button class="btn-regresar">Regresar</button>
        <h1 class="titulo">Creación de espacios académicos</h1>
    </mat-card-header>
    <mat-card-content>
        <mat-stepper orientation="vertical" [linear]="false" #stepper>
            <mat-step [stepControl]="formProyecto">
                <ng-template matStepLabel>Seleccionar proyecto curricular</ng-template>
                <form [formGroup]="formProyecto">
                    <div class="proyecto">
                        <mat-form-field>
                            <mat-label>Nivel</mat-label>
                            <mat-select formControlName="nivel" (selectionChange)="onNivelChange($event)">
                                <mat-option *ngFor="let nivel of niveles"
                                    [value]="nivel.Id">{{nivel.Nombre}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <mat-form-field>
                            <mat-label>Sub nivel</mat-label>
                            <mat-select formControlName="sub_nivel" (selectionChange)="onSubNivelChange($event)">
                                <ng-container *ngIf="nivelSeleccionado === 1">
                                    <mat-option *ngFor="let nivel of subNivelesPregrado" [value]="nivel.Id">{{
                                        nivel.Nombre}}</mat-option>
                                </ng-container>
                                <ng-container *ngIf="nivelSeleccionado === 2">
                                    <mat-option *ngFor="let nivel of subNivelesPosgrado" [value]="nivel.Id">{{
                                        nivel.Nombre}}</mat-option>
                                </ng-container>
                            </mat-select>
                        </mat-form-field>
                        <mat-form-field>
                            <mat-label>Proyecto curricular</mat-label>
                            <mat-select formControlName="proyecto_curricular"
                                (selectionChange)="onProyectoChange($event)">
                                <mat-option *ngFor="let proyecto of proyectosSelect" [value]="proyecto.Id">{{
                                    proyecto.Nombre}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div>
                        <button mat-raised-button matStepperNext>Siguiente</button>
                    </div>
                </form>
            </mat-step>
            <mat-step [stepControl]="formEspacioAcademico">
                <ng-template matStepLabel>Información sobre el espacio académico</ng-template>
                <form [formGroup]="formEspacioAcademico" class="espacio-academico">
                    <mat-form-field>
                        <mat-label>Nombre</mat-label>
                        <input matInput formControlName="nombre">
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Código</mat-label>
                        <input matInput formControlName="codigo">
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Código abreviación</mat-label>
                        <input matInput formControlName="codigo_abreviacion">
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Plan de estudios</mat-label>
                        <input matInput type="number" formControlName="plan_estudios">
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Tipo</mat-label>
                        <mat-select formControlName="tipo">
                            <mat-option *ngFor="let tipo of tipos" [value]="tipo.Id">{{tipo.Nombre}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Clase</mat-label>
                        <mat-select formControlName="clase">
                            <mat-option *ngFor="let clase of clases" [value]="clase.Id">{{clase.Nombre}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Enfoque</mat-label>
                        <mat-select formControlName="enfoque">
                            <mat-option *ngFor="let enfoque of enfoques"
                                [value]="enfoque.Id">{{enfoque.Nombre}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Créditos</mat-label>
                        <input matInput type="number" formControlName="creditos">
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Espacio modular</mat-label>
                        <mat-select formControlName="espacio_modular">
                            <mat-option value="true">Si</mat-option>
                            <mat-option value="false">No</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Agrupación espacios académicos</mat-label>
                        <mat-select formControlName="agrupacion_espacios"
                            (selectionChange)="onAgrupacionEspaciosChange($event)">
                            <mat-option *ngFor="let agrupacion of agrupacionEspacios"
                                [value]="agrupacion._id">{{agrupacion.nombre}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field floatLabel="always">
                        <input class="color-box" matInput formControlName="agrupacion_espacios_color" type="text"
                            readonly [style.background-color]="inputBoxColor">
                    </mat-form-field>
                    <button mat-raised-button color="primary" class="btn-agregar-agrupacion">Agregar agrupación
                        espacios académicos</button>
                    <div class="horas-trabajo">
                        <h5>Asignar horas de trabajo</h5>
                        <mat-form-field>
                            <mat-label>HTD</mat-label>
                            <input matInput type="number" formControlName="htd">
                        </mat-form-field>
                        <mat-form-field>
                            <mat-label>HTC</mat-label>
                            <input matInput type="number" formControlName="htc">
                        </mat-form-field>
                        <mat-form-field>
                            <mat-label>HTA</mat-label>
                            <input matInput type="number" formControlName="hta">
                        </mat-form-field>
                        <mat-form-field>
                            <mat-label>Total</mat-label>
                            <input matInput type="number" formControlName="total">
                        </mat-form-field>
                        <p>Se debe asignar un total de x horas de trabajo</p>
                    </div>
                    <mat-form-field>
                        <mat-label>Grupos</mat-label>
                        <input matInput formControlName="grupos">
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Espacios requeridos (pre requisitos)</mat-label>
                        <mat-select formControlName="espacios_requeridos" multiple
                            (selectionChange)="obtenerEspaciosRequeridos($event)">
                            <mat-option *ngFor="let espacio of espaciosAcademicos"
                                [value]="espacio._id">{{espacio.nombre}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </form>
                <div class="espacios-requeridos">
                    <mat-card>
                        <mat-card-header>
                            <mat-card-title>
                                Espacios requeridos (pre requisitos)
                            </mat-card-title>
                        </mat-card-header>
                        <mat-card-content>
                            <mat-list role="list">
                                <ng-container *ngIf="espaciosRequeridos">
                                    <mat-list-item *ngFor="let espacio of espaciosRequeridos"
                                        role="listitem">{{espacio.nombre}}</mat-list-item>
                                </ng-container>
                                <ng-container *ngIf="!(espaciosRequeridos?.length)">
                                    <mat-list-item role="listitem">No requiere</mat-list-item>
                                </ng-container>
                            </mat-list>
                        </mat-card-content>
                    </mat-card>
                </div>
                <div class="botones-step">
                    <button mat-raised-button matStepperPrevious>Anterior</button>
                    <button mat-raised-button matStepperNext>Siguiente</button>
                </div>
            </mat-step>
            <mat-step [stepControl]="formSoportes">
                <ng-template matStepLabel>Carga de soportes y observaciones</ng-template>
                <form [formGroup]="formSoportes" class="soporte">
                    <p>Soporte documental (puede agregar varios archivos si lo requiere)</p>
                    <mat-form-field class="campo-archivos">
                        <div id="dropzone" (drop)="onDrop($event)" (dragover)="onDragOver($event)">
                            <p>Arastre los archivos a esta zona <label for="archivos">o haga click aquí</label></p>
                            <input type="file" id="archivos" name="archivos"
                                (change)="onChangeArchivosSeleccionados($event)" multiple />
                        </div>
                        <div *ngIf="archivosSoporte" class="archivos-soporte">
                            <mat-list role="list">
                                <mat-list-item *ngFor="let archivo of archivosSoporte" role="listitem"><a href="#"
                                        (click)="abrirArchivo(archivo)" class="link-archivo">{{ archivo.name }}
                                    </a><span (click)="eliminarArchivo(archivo)"
                                        class="eliminar-archivo">X</span></mat-list-item>
                            </mat-list>
                        </div>
                        <input matInput formControlName="soporte" type="text" readonly [value]="archivosSoporte && archivosSoporte.length > 0 ? 'Archivo(s) cargado(s)' : 'Archivo(s) NO cargado(s)'">
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Aprobación de espacio académico</mat-label>
                        <mat-select formControlName="aprobado">
                            <mat-option *ngFor="let estado of estadosAprobacion"
                                [value]="estado._id">{{estado.nombre}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Aprobación de espacio académico</mat-label>
                        <textarea matInput formControlName="observaciones"></textarea>
                    </mat-form-field>
                </form>
                <div>
                    <button mat-raised-button matStepperPrevious>Anterior</button>
                </div>
            </mat-step>
        </mat-stepper>
    </mat-card-content>
</mat-card>